axis.text = element_text(size = 10),
axis.text.y = element_blank(),
axis.title = element_text(size = 10),
legend.title = element_blank(),
legend.position = "none",
legend.text = element_text(size = 10),
panel.spacing = unit(0.5, "lines"),
panel.grid.major = element_blank(),
strip.background = element_rect(fill = "white", size = 0.5, linetype = "solid"),
strip.text.x = element_text(size = 10, color = "black")
)
## SD temperature
### Mean
beta_sd_temp_mean <-
div_env_df %>%
filter(scale == "beta", year == "Mean", group == "Whole-community") %>%
ggplot(aes(x = sd_temp_12M, y = diversity, colour = group), color = color_group[1]) +
geom_point(data = subset(div_env_df, scale == "beta" & year == "Mean" & group == "Whole-community"), aes(color = group), color = color_group[1]) +
# geom_smooth(data = subset(div_env_df, scale == "beta" & year == "Mean" & group == "Whole-community"),
#             aes(group = group == "Whole-community"), color = color_group[1],
#             method = "lm", size = 1.25, formula = formula) + # not significant
geom_point(data = subset(div_env_df, scale == "beta" & year == "Mean" & group == "Bacteria"), aes(color = group), color = color_group[2]) +
# geom_smooth(data = subset(div_env_df, scale == "beta" & year == "Mean" & group == "Bacteria"),
#             aes(group = group == "Bacteria"), color = color_group[2],
#             method = "lm", size = 1.25, formula = formula) + # not significant
geom_point(data = subset(div_env_df, scale == "beta" & year == "Mean" & group == "Phytoplankton"), aes(color = group), color = color_group[3]) +
geom_smooth(data = subset(div_env_df, scale == "beta" & year == "Mean" & group == "Phytoplankton"),
aes(group = group == "Phytoplankton"), color = color_group[3],
method = "lm", size = 1.25, formula = formula) +
geom_point(data = subset(div_env_df, scale == "beta" & year == "Mean" & group == "Zooplankton"), aes(color = group), color = color_group[4]) +
# geom_smooth(data = subset(div_env_df, scale == "beta" & year == "Mean" & group == "Zooplankton"),
#             aes(group = group == "Zooplankton"), color = color_group[4],
#             method = "lm", size = 1.25, formula = formula) + # not significant
geom_point(data = subset(div_env_df, scale == "beta" & year == "Mean" & group == "Macroinvertebrates"), aes(color = group), color = color_group[5]) +
geom_smooth(data = subset(div_env_df, scale == "beta" & year == "Mean" & group == "Macroinvertebrates"),
aes(group = group == "Macroinvertebrates"), color = color_group[5],
method = "lm", size = 1.25, formula = formula) +
scale_color_manual(values = color_group, name = "", labels = group_labels) +
scale_fill_manual(values = color_group, guide = FALSE) +
ylim(0, 6) +
xlim(1.8, 2.2) +
scale_x_continuous(breaks = c(1.9, 2.0, 2.1)) +
xlab("") +
ylab(expression("Temporal average "*beta*"-diversity")) +
ggtitle("Turnover") +theme_tq() +
theme_tq() +
theme(plot.title = element_text(hjust = 0.5, size = 10, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, face = "italic"),
axis.text = element_text(size = 10),
axis.text.y = element_blank(),
axis.title = element_text(size = 10),
legend.title = element_blank(),
legend.position = "none",
legend.text = element_text(size = 10),
panel.spacing = unit(0.5, "lines"),
panel.grid.major = element_blank(),
strip.background = element_rect(fill = "white", size = 0.5, linetype = "solid"),
strip.text.x = element_text(size = 10, color = "black")
)
### 2016
beta_sd_temp_2016 <-
div_env_df %>%
filter(scale == "beta", year == "2016", group == "Whole-community") %>%
ggplot(aes(x = sd_temp_12M, y = diversity, colour = group)) +
geom_point(data = subset(div_env_df, scale == "beta" & year == "2016" & group == "Whole-community"), aes(color = group), color = color_group[1]) +
geom_smooth(data = subset(div_env_df, scale == "beta" & year == "2016" & group == "Whole-community"),
aes(group = group == "Whole-community"), color = color_group[1],
method = "lm", size = 1.25, formula = y~x) +
geom_point(data = subset(div_env_df, scale == "beta" & year == "2016" & group == "Bacteria"), aes(color = group), color = color_group[2]) +
geom_smooth(data = subset(div_env_df, scale == "beta" & year == "2016" & group == "Bacteria"),
aes(group = group == "Bacteria"), color = color_group[2],
method = "lm", size = 1.25, formula = y~x) +
geom_point(data = subset(div_env_df, scale == "beta" & year == "2016" & group == "Phytoplankton"), aes(color = group), color = color_group[3]) +
geom_smooth(data = subset(div_env_df, scale == "beta" & year == "2016" & group == "Phytoplankton"),
aes(group = group == "Phytoplankton"), color = color_group[3],
method = "lm", size = 1.25, formula = y~x) +
geom_point(data = subset(div_env_df, scale == "beta" & year == "2016" & group == "Zooplankton"), aes(color = group), color = color_group[4]) +
# geom_smooth(data = subset(div_env_df, scale == "beta" & year == "2016" & group == "Zooplankton"),
#             aes(group = group == "Zooplankton"), color = color_group[4],
#             method = "lm", size = 1.25, formula = formula) + # not significant
geom_point(data = subset(div_env_df, scale == "beta" & year == "2016" & group == "Macroinvertebrates"), aes(color = group), color = color_group[5]) +
# geom_smooth(data = subset(div_env_df, scale == "beta" & year == "2016" & group == "Macroinvertebrates"),
#             aes(group = group == "Macroinvertebrates"), color = color_group[5],
#             method = "lm", size = 1.25, formula = formula) + # not significant
scale_color_manual(values = color_group, name = "", labels = group_labels) +
scale_fill_manual(values = color_group, guide = FALSE) +
ylim(0, 6) +
xlim(1.80, 2.2) +
scale_x_continuous(breaks = c(1.9, 2.1)) +
xlab("") +
ylab("") +
ggtitle("2016") +
theme_tq() +
theme(plot.title = element_text(hjust = 0.5, size = 10, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, face = "italic"),
axis.text = element_text(size = 10),
axis.text.y = element_blank(),
axis.title = element_text(size = 10),
legend.title = element_blank(),
legend.position = "none",
legend.text = element_text(size = 10),
panel.spacing = unit(0.5, "lines"),
panel.grid.major = element_blank(),
strip.background = element_rect(fill = "white", size = 0.5, linetype = "solid"),
strip.text.x = element_text(size = 10, color = "black")
)
### 2017
beta_sd_temp_2017 <-
div_env_df %>%
filter(scale == "beta", year == "2017", group == "Whole-community") %>%
ggplot(aes(x = sd_temp_12M, y = diversity, colour = group)) +
geom_point(data = subset(div_env_df, scale == "beta" & year == "2017" & group == "Whole-community"), aes(color = group), color = color_group[1]) +
# geom_smooth(data = subset(div_env_df, scale == "beta" & year == "2017" & group == "Whole-community"),
#             aes(group = group == "Whole-community"), color = color_group[1],
#             method = "lm", size = 1.25, formula = formula) + # not significant
geom_point(data = subset(div_env_df, scale == "beta" & year == "2017" & group == "Bacteria"), aes(color = group), color = color_group[2]) +
# geom_smooth(data = subset(div_env_df, scale == "beta" & year == "2017" & group == "Bacteria"),
#             aes(group = group == "Bacteria"), color = color_group[2],
#             method = "lm", size = 1.25, formula = formula) + # not significant
geom_point(data = subset(div_env_df, scale == "beta" & year == "2017" & group == "Phytoplankton"), aes(color = group), color = color_group[3]) +
# geom_smooth(data = subset(div_env_df, scale == "beta" & year == "2017" & group == "Phytoplankton"),
#             aes(group = group == "Phytoplankton"), color = color_group[3],
#             method = "lm", size = 1.25, formula = formula) + # not significant
geom_point(data = subset(div_env_df, scale == "beta" & year == "2017" & group == "Zooplankton"), aes(color = group), color = color_group[4]) +
# geom_smooth(data = subset(div_env_df, scale == "beta" & year == "2017" & group == "Zooplankton"),
#             aes(group = group == "Zooplankton"), color = color_group[4],
#             method = "lm", size = 1.25, formula = formula) + # not significant
geom_point(data = subset(div_env_df, scale == "beta" & year == "2017" & group == "Macroinvertebrates"), aes(color = group), color = color_group[5]) +
geom_smooth(data = subset(div_env_df, scale == "beta" & year == "2017" & group == "Macroinvertebrates"),
aes(group = group == "Macroinvertebrates"), color = color_group[5],
method = "lm", size = 1.25, formula = y~x) +
scale_color_manual(values = color_group, name = "", labels = group_labels) +
scale_fill_manual(values = color_group, guide = FALSE) +
ylim(0, 6) +
xlim(1.80, 2.2) +
scale_x_continuous(breaks = c(1.9, 2.1)) +
xlab("") +
ylab("") +
ggtitle("2017") +
theme_tq() +
theme(plot.title = element_text(hjust = 0.5, size = 10, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, face = "italic"),
axis.text = element_text(size = 10),
axis.text.y = element_blank(),
axis.title = element_text(size = 10),
legend.title = element_blank(),
legend.position = "none",
legend.text = element_text(size = 10),
panel.spacing = unit(0.5, "lines"),
panel.grid.major = element_blank(),
strip.background = element_rect(fill = "white", size = 0.5, linetype = "solid"),
strip.text.x = element_text(size = 10, color = "black")
)
### 2018
beta_sd_temp_2018 <-
div_env_df %>%
filter(scale == "beta", year == "2018", group == "Whole-community") %>%
ggplot(aes(x = sd_temp_12M, y = diversity, colour = group)) +
geom_point(data = subset(div_env_df, scale == "beta" & year == "2018" & group == "Whole-community"), aes(color = group), color = color_group[1]) +
# geom_smooth(data = subset(div_env_df, scale == "beta" & year == "2018" & group == "Whole-community"),
#             aes(group = group == "Whole-community"), color = color_group[1],
#             method = "lm", size = 1.25, formula = formula) + # not significant
geom_point(data = subset(div_env_df, scale == "beta" & year == "2018" & group == "Bacteria"), aes(color = group), color = color_group[2]) +
# geom_smooth(data = subset(div_env_df, scale == "beta" & year == "2018" & group == "Bacteria"),
#             aes(group = group == "Bacteria"), color = color_group[2],
#             method = "lm", size = 1.25, formula = y~x) + # not significant
geom_point(data = subset(div_env_df, scale == "beta" & year == "2018" & group == "Phytoplankton"), aes(color = group), color = color_group[3]) +
# geom_smooth(data = subset(div_env_df, scale == "beta" & year == "2018" & group == "Phytoplankton"),
#             aes(group = group == "Phytoplankton"), color = color_group[3],
#             method = "lm", size = 1.25, formula = formula) + # not significant
geom_point(data = subset(div_env_df, scale == "beta" & year == "2018" & group == "Zooplankton"), aes(color = group), color = color_group[4]) +
# geom_smooth(data = subset(div_env_df, scale == "beta" & year == "2018" & group == "Zooplankton"),
#             aes(group = group == "Zooplankton"), color = color_group[4],
#             method = "lm", size = 1.25, formula = formula) + # not significant
geom_point(data = subset(div_env_df, scale == "beta" & year == "2018" & group == "Macroinvertebrates"), aes(color = group), color = color_group[5]) +
# geom_smooth(data = subset(div_env_df, scale == "beta" & year == "2018" & group == "Macroinvertebrates"),
#             aes(group = group == "Macroinvertebrates"), color = color_group[5],
#             method = "lm", size = 1.25, formula = formula) + # not significant
scale_color_manual(values = color_group, name = "", labels = group_labels) +
scale_fill_manual(values = color_group, guide = FALSE) +
ylim(0, 6) +
xlim(1.80, 2.2) +
scale_x_continuous(breaks = c(1.9, 2.1)) +
xlab("") +
ylab("") +
ggtitle("2018") +
theme_tq() +
theme(plot.title = element_text(hjust = 0.5, size = 10, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, face = "italic"),
axis.text = element_text(size = 10),
axis.text.y = element_blank(),
axis.title = element_text(size = 10),
legend.title = element_blank(),
legend.position = "none",
legend.text = element_text(size = 10),
panel.spacing = unit(0.5, "lines"),
panel.grid.major = element_blank(),
strip.background = element_rect(fill = "white", size = 0.5, linetype = "solid"),
strip.text.x = element_text(size = 10, color = "black")
)
gamma_tmean <- ggarrange(gamma_mean_temp_mean + rremove("ylab") + rremove("xlab"),
common.legend = T, legend = "bottom")
gamma_tmean <- annotate_figure(gamma_tmean,
left = text_grob(expression("Temporal average  "*gamma*"-diversity"), rot = 90, vjust = 1, size = 10),
bottom = text_grob(bquote(Log[10]~T[Mean]~(ºC)), size = 10))
alpha_tmean <- ggarrange(alpha_mean_temp_mean + rremove("ylab") + rremove("xlab"),
common.legend = T, legend = "bottom")
alpha_tmean <- annotate_figure(alpha_tmean,
left = text_grob(expression("Temporal average  "*alpha*"-diversity"), rot = 90, vjust = 1, size = 10),
bottom = text_grob(bquote(Log[10]~T[Mean]~(ºC)), size = 10))
beta_tmean <- ggarrange(beta_mean_temp_mean + rremove("ylab") + rremove("xlab"),
common.legend = T, legend = "bottom")
beta_tmean <- annotate_figure(beta_tmean,
left = text_grob(expression("Temporal average  "*beta*"-diversity"), rot = 90, vjust = 1, size = 10),
bottom = text_grob(bquote(Log[10]~T[Mean]~(ºC)), size = 10))
gamma_years_tmean <- ggarrange(gamma_mean_temp_2016 + rremove("ylab") + rremove("xlab"),
gamma_mean_temp_2017 + rremove("ylab") + rremove("xlab"),
gamma_mean_temp_2018 + rremove("ylab") + rremove("xlab"),
nrow = 1, ncol = 3, widths = c(1.3, 1, 1),
common.legend = T, legend = "bottom")
gamma_years_tmean <- annotate_figure(gamma_years_tmean,
left = text_grob(expression("Annual  "*gamma*"-diversity"), rot = 90, vjust = 1, size = 10),
bottom = text_grob(bquote(Log[10]~T[Mean]~(ºC)), size = 10))
alpha_years_tmean <- ggarrange(alpha_mean_temp_2016 + rremove("ylab") + rremove("xlab"),
alpha_mean_temp_2017 + rremove("ylab") + rremove("xlab"),
alpha_mean_temp_2018 + rremove("ylab") + rremove("xlab"),
nrow = 1, ncol = 3, widths = c(1.3, 1, 1),
common.legend = T, legend = "bottom")
alpha_years_tmean <- annotate_figure(alpha_years_tmean,
left = text_grob(expression("Annual  "*alpha*"-diversity"), rot = 90, vjust = 1, size = 10),
bottom = text_grob(bquote(Log[10]~T[Mean]~(ºC)), size = 10))
beta_years_tmean <- ggarrange(beta_mean_temp_2016 + rremove("ylab") + rremove("xlab"),
beta_mean_temp_2017 + rremove("ylab") + rremove("xlab"),
beta_mean_temp_2018 + rremove("ylab") + rremove("xlab"),
nrow = 1, ncol = 3, widths = c(1.1, 1, 1),
common.legend = T, legend = "bottom")
beta_years_tmean <- annotate_figure(beta_years_tmean,
left = text_grob(expression("Annual  "*beta*"-diversity"), rot = 90, vjust = 1, size = 10),
bottom = text_grob(bquote(Log[10]~T[Mean]~(ºC)), size = 10))
div_mean_temp_plot <- ggarrange(alpha_tmean, gamma_tmean, beta_tmean,
alpha_years_tmean, gamma_years_tmean, beta_years_tmean,
nrow = 2, ncol = 3,
common.legend = T, legend = "bottom", labels = "AUTO")
div_mean_temp_plot
# --------------------------------------------
# Export Figure 3
# --------------------------------------------
ggsave(
"../figures/Figure_3_div_mean_temp_plot.png",
plot = div_mean_temp_plot,
dpi = 300, width = 14, height = 11.2, units = "in"
)
# div_avg_mean_temp_plot <- ggarrange(alpha_tmean, gamma_tmean, beta_tmean,
#                                     nrow = 1, ncol = 3,
#                                     common.legend = T, legend = "bottom", labels = "AUTO")
# div_avg_mean_temp_plot
# div_year_mean_temp_plot <- ggarrange(alpha_years_tmean, gamma_years_tmean, beta_years_tmean,
#                                      nrow = 1, ncol = 3,
#                                      common.legend = T, legend = "bottom", labels = "AUTO")
# div_year_mean_temp_plot
gamma_tsd <- ggarrange(gamma_sd_temp_mean + rremove("ylab") + rremove("xlab"),
common.legend = T, legend = "bottom")
gamma_tsd <- annotate_figure(gamma_tsd,
left = text_grob(expression("Temporal average  "*gamma*"-diversity"), rot = 90, vjust = 1, size = 16),
bottom = text_grob(bquote(Log[10]~T[SD]~(ºC)), size = 14))
alpha_tsd <- ggarrange(alpha_sd_temp_mean + rremove("ylab") + rremove("xlab"),
common.legend = T, legend = "bottom")
alpha_tsd <- annotate_figure(alpha_tsd,
left = text_grob(expression("Temporal average  "*alpha*"-diversity"), rot = 90, vjust = 1, size = 16),
bottom = text_grob(bquote(Log[10]~T[SD]~(ºC)), size = 14))
beta_tsd <- ggarrange(beta_sd_temp_mean + rremove("ylab") + rremove("xlab"),
common.legend = T, legend = "bottom")
beta_tsd <- annotate_figure(beta_tsd,
left = text_grob(expression("Temporal average  "*beta*"-diversity"), rot = 90, vjust = 1, size = 16),
bottom = text_grob(bquote(Log[10]~T[SD]~(ºC)), size = 14))
gamma_years_tsd <- ggarrange(gamma_sd_temp_2016 + rremove("ylab") + rremove("xlab"),
gamma_sd_temp_2017 + rremove("ylab") + rremove("xlab"),
gamma_sd_temp_2018 + rremove("ylab") + rremove("xlab"),
nrow = 1, ncol = 3, widths = c(1.3, 1, 1),
common.legend = T, legend = "bottom")
gamma_years_tsd <- annotate_figure(gamma_years_tsd,
left = text_grob(expression("Annual  "*gamma*"-diversity"), rot = 90, vjust = 1, size = 16),
bottom = text_grob(bquote(Log[10]~T[SD]~(ºC)), size = 14))
alpha_years_tsd <- ggarrange(alpha_sd_temp_2016 + rremove("ylab") + rremove("xlab"),
alpha_sd_temp_2017 + rremove("ylab") + rremove("xlab"),
alpha_sd_temp_2018 + rremove("ylab") + rremove("xlab"),
nrow = 1, ncol = 3, widths = c(1.3, 1, 1),
common.legend = T, legend = "bottom")
alpha_years_tsd <- annotate_figure(alpha_years_tsd,
left = text_grob(expression("Annual  "*alpha*"-diversity"), rot = 90, vjust = 1, size = 16),
bottom = text_grob(bquote(Log[10]~T[SD]~(ºC)), size = 14))
beta_years_tsd <- ggarrange(beta_sd_temp_2016 + rremove("ylab") + rremove("xlab"),
beta_sd_temp_2017 + rremove("ylab") + rremove("xlab"),
beta_sd_temp_2018 + rremove("ylab") + rremove("xlab"),
nrow = 1, ncol = 3, widths = c(1.1, 1, 1),
common.legend = T, legend = "bottom")
beta_years_tsd <- annotate_figure(beta_years_tsd,
left = text_grob(expression("Annual  "*beta*"-diversity"), rot = 90, vjust = 1, size = 16),
bottom = text_grob(bquote(Log[10]~T[SD]~(ºC)), size = 14))
div_sd_temp_plot <- ggarrange(alpha_tsd, gamma_tsd, beta_tsd,
alpha_years_tsd, gamma_years_tsd, beta_years_tsd,
nrow = 2, ncol = 3,
common.legend = T, legend = "bottom", labels = "AUTO")
div_sd_temp_plot
# --------------------------------------------
# Export Figure 4
# --------------------------------------------
ggsave(
"../figures/Figure_4_div_sd_temp_plot.png",
plot = div_sd_temp_plot,
dpi = 300, width = 14, height = 11.2, units = "in"
)
# div_avg_sd_temp_plot <- ggarrange(alpha_tsd, gamma_tsd, beta_tsd,
#                                   nrow = 1, ncol = 3,
#                                   common.legend = T, legend = "bottom", labels = "AUTO")
# div_avg_sd_temp_plot
# div_year_sd_temp_plot <- ggarrange(alpha_yearsa_tsd, gamma_yearsa_tsd, beta_yearsa_tsd,
#                                    nrow = 1, ncol = 3,
#                                    common.legend = T, legend = "bottom", labels = "AUTO")
# div_year_sd_temp_plot
target <- c("domain", "kingdom", "phylum", "class", "order", "family", "genus", "species") # to order rows
# Bacteria
id.bact <- community.df %>%
filter(group == "bacteria") %>% # filter taxonomic group
group_by(id_level) %>% # group by id level
summarise(cnt = n()) %>% # count nr by id level
mutate(perc = round((cnt / sum(cnt) * 100), 2)) %>% # calculate percentages by id level
rbind(data.frame(id_level = "domain", cnt = 0, perc = 0)) %>% # add missing id level
slice(match(target, id_level)) # order rows
# Phytoplankton
id.phyto <- community.df %>%
filter(group == "phytoplankton") %>%
group_by(id_level) %>%
summarise(cnt = n()) %>%
mutate(perc = round((cnt / sum(cnt) * 100), 2)) %>%
#rbind(data.frame(id_level = "domain", cnt = 0, perc = 0)) %>%
slice(match(target, id_level))
# Zooplankton
id.zoo <- community.df %>%
filter(group == "zooplankton") %>%
group_by(id_level) %>%
summarise(cnt = n()) %>%
mutate(perc = round((cnt / sum(cnt) * 100), 2)) %>%
rbind(data.frame(id_level = c("domain", "kingdom", "phylum"), cnt = c(0, 0, 0), perc = c(0, 0, 0))) %>%
slice(match(target, id_level))
# Macroinvertebrates
id.macro <- community.df %>%
filter(group == "macroinvertebrates") %>%
group_by(id_level) %>%
summarise(cnt = n()) %>%
mutate(perc = round((cnt / sum(cnt) * 100), 2)) %>%
rbind(data.frame(id_level = "domain", cnt = 0, perc = 0)) %>%
slice(match(target, id_level))
id.all <- data.frame(
Trophic_group = rep(c("Bacteria", "Phytoplankton", "Zooplankton", "Macroinvertebrates"), each = 8),
Taxonomic_rank = rep(c("Domain", "Kingdom", "Phylum", "Class", "Order", "Family", "Genus", "Species"), 4),
Percentage = c(id.bact$perc, id.phyto$perc, id.zoo$perc, id.macro$perc)
)
# Set blank theme
blank_theme <- theme_minimal()+
theme(
axis.title.x = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.ticks = element_blank()
)
# Set colors
mycol <- viridis(8, option = "D", direction = -1)
# Plot cumulative bar plots with identification level
p.id.all <- id.all %>%
ggplot(aes(x = factor(Trophic_group,
levels = c("Bacteria", "Phytoplankton", "Zooplankton", "Macroinvertebrates"),
labels = c("Bacteria", "Phytoplankton", "Zooplankton", "Macroinvertebrates")),
y = Percentage,
fill = factor(Taxonomic_rank, levels = c("Domain", "Kingdom", "Phylum", "Class", "Order", "Family", "Genus", "Species")))) +
geom_bar(position = "stack", stat = "identity") +
geom_text(aes(
label = ifelse(Percentage > 3, paste0(Percentage, "%"), ""),
color = "white"),
position = position_stack(vjust = 0.5),
size = 2,
show.legend = FALSE) +
scale_color_identity() +
scale_fill_manual(values = mycol) +
xlab("") +
ylab("Taxonomic Resolution") +
blank_theme +
theme(axis.text = element_text(size = 10),
axis.text.y = element_blank(),
axis.title = element_text(size = 10),
legend.text = element_text(size = 8),
legend.position = "bottom",
legend.direction = "horizontal",
legend.title = element_blank())
p.id.all
# --------------------------------------------
# Export Figure S2
# --------------------------------------------
ggsave(
"../figures/Figure_S2_p.id.all.png",
plot = p.id.all,
dpi = 300, width = 8, units = "in"
)
# Mean regional diversity
reg_mean <- div_env_df %>%
filter(scale == "gamma", year == "Mean") %>%
ggplot(aes(x = group, y = diversity, fill = group)) +
facet_grid(.~site) +
geom_bar(stat = "identity", position = "dodge", width = 0.8, outlier.shape = NA) +
scale_fill_manual(values = color_group, name = "", labels = c("W: Whole-community", "B: Bacteria", "P: Phytoplankton", "Z: Zooplankton", "M: Macroinvertebrates")) +
scale_x_discrete(label = c("W", "B", "P", "Z", "M")) +
labs(x = "Trophic Group", y = expression("Average "*gamma*"-diversity (Temporal)"), title = "Temporal averaging regional diversity") +
ylim(0, 600) +
theme_tq() +
theme(plot.title = element_text(hjust = 0, size = 10, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, face = "italic"),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.title = element_blank(),
legend.position = "none",
legend.text = element_text(size = 10),
panel.spacing = unit(0.5, "lines"),
panel.grid.major = element_blank(),
#panel.grid.minor = element_blank(),
strip.background = element_rect(fill = "white", size = 0.5, linetype = "solid"),
strip.text.x = element_text(size = 10, color = "black")
)
# 2016 Annual regional diversity
reg_2016 <- div_env_df %>%
filter(scale == "gamma", year == "2016") %>%
ggplot(aes(x = group, y = diversity, fill = group)) +
facet_grid(.~site) +
geom_bar(stat = "identity", position = "dodge", width = 0.8, outlier.shape = NA) +
scale_fill_manual(values = color_group, name = "", labels = c("W: Whole-community", "B: Bacteria", "P: Phytoplankton", "Z: Zooplankton", "M: Macroinvertebrates")) +
scale_x_discrete(label = c("W", "B", "P", "Z", "M")) +
labs(x = "Trophic Group", y = expression("Annual "*gamma*"-diversity"), title = "2016 Annual regional diversity") +
ylim(0, 600) +
theme_tq() +
theme(plot.title = element_text(hjust = 0, size = 10, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, face = "italic"),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.title = element_blank(),
legend.position = "none",
legend.text = element_text(size = 10),
panel.spacing = unit(0.5, "lines"),
panel.grid.major = element_blank(),
#panel.grid.minor = element_blank(),
strip.background = element_rect(fill = "white", size = 0.5, linetype = "solid"),
strip.text.x = element_text(size = 10, color = "black")
)
# 2017 Annual regional diversity
reg_2017 <- div_env_df %>%
filter(scale == "gamma", year == "2017") %>%
ggplot(aes(x = group, y = diversity, fill = group)) +
facet_grid(.~site) +
geom_bar(stat = "identity", position = "dodge", width = 0.8, outlier.shape = NA) +
scale_fill_manual(values = color_group, name = "", labels = c("W: Whole-community", "B: Bacteria", "P: Phytoplankton", "Z: Zooplankton", "M: Macroinvertebrates")) +
scale_x_discrete(label = c("W", "B", "P", "Z", "M")) +
labs(x = "Trophic Group", y = expression("Annual "*gamma*"-diversity"), title = "2017 Annual regional diversity") +
ylim(0, 600) +
theme_tq() +
theme(plot.title = element_text(hjust = 0, size = 10, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, face = "italic"),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.title = element_blank(),
legend.position = "none",
legend.text = element_text(size = 10),
panel.spacing = unit(0.5, "lines"),
panel.grid.major = element_blank(),
#panel.grid.minor = element_blank(),
strip.background = element_rect(fill = "white", size = 0.5, linetype = "solid"),
strip.text.x = element_text(size = 10, color = "black")
)
# 2018 Annual regional diversity
reg_2018 <- div_env_df %>%
filter(scale == "gamma", year == "2018") %>%
ggplot(aes(x = group, y = diversity, fill = group)) +
facet_grid(.~site) +
geom_bar(stat = "identity", position = "dodge", width = 0.8, outlier.shape = NA) +
scale_fill_manual(values = color_group, name = "", labels = c("W: Whole-community", "B: Bacteria", "P: Phytoplankton", "Z: Zooplankton", "M: Macroinvertebrates")) +
scale_x_discrete(label = c("W", "B", "P", "Z", "M")) +
labs(x = "Trophic group", y = expression("Annual "*gamma*"-diversity"), title = "2018 Annual regional diversity") +
ylim(0, 600) +
theme_tq() +
theme(plot.title = element_text(hjust = 0, size = 10, face = "bold"),
plot.subtitle = element_text(hjust = 0.5, face = "italic"),
axis.text = element_text(size = 10),
axis.title = element_text(size = 10),
legend.title = element_blank(),
legend.position = "none",
legend.text = element_text(size = 10),
panel.spacing = unit(0.5, "lines"),
panel.grid.major = element_blank(),
#panel.grid.minor = element_blank(),
strip.background = element_rect(fill = "white", size = 0.5, linetype = "solid"),
strip.text.x = element_text(size = 10, color = "black")
)
reg_div <- ggarrange(reg_mean, reg_2016, reg_2017, reg_2018,
nrow = 2, ncol = 2,
labels = "AUTO", font.label = list(size = 10),
common.legend = T, legend = "bottom")
reg_div
# --------------------------------------------
# Export Figure S3
# --------------------------------------------
ggsave(
"../figures/Figure_S3_reg_div.png",
plot = reg_div,
dpi = 300, width = 10, height = 8, units = "in"
)
